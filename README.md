# SneakySnake: A New Fast and Highly Accurate Pre-Alignment Filter on CPU, GPU, and FPGA for Accelerating Sequence Alignment
The first and the only work that introduces three new efficient pre-alignment filters (*SneakySnake*, *Snake-on-Chip*, and *Snake-on-GPU*) that work efficiently and fast on CPU, GPU, and FPGA architectures and that greatly (by more than two orders of magnitude) expedite sequence alignment. This work is led by Alser et al. (2019).

# Motivation
One of the most fundamental computational steps in most bioinformatics analyses is genomic *sequence alignment*. The execution time of this step constitutes the *main* performance bottleneck in genome analysis, as it is typically solved using computationally expensive dynamic programming algorithms. It gets even worse when one tries to understand a complex disease (e.g., autism and cancer) or profile a metagenomics sample, which requires analyzing hundreds of thousands of genomes. The long execution time of modern-day sequence aligners can severely hinder such studies. **Our goal** in this work is to significantly reduce the time spent on calculating the sequence alignment of short sequences using very fast and highly accurate pre-alignment filtering. 

# Our Solution
To this end, **we introduce three new, fast, and very accurate pre-alignment filters, called *SneakySnake*, *Snake-on-Chip*, and *Snake-on-GPU* for different computing platforms**. Each of these pre-alignment filters serves as an additional processing step in genome analysis and offers the ability to *accurately examine* the input genomic sequences and quickly decide whether or not a computationally-costly sequence alignment step is needed to be performed for the sequences. Hence, we call this step as a *pre-alignment filtering step*. 

The key idea of SneakySnake is to provide fast and highly accurate filtering by reducing the sequence alignment problem (formulated as an approximate string matching (ASM) problem) to the single net routing (SNR) problem in VLSI chip layout. The SNR problem is to find the shortest routing path that interconnects two terminals on the boundaries of VLSI chip layout and passes through the minimum number of obstacles. Solving the SNR problem is faster than solving the ASM problem, as calculating the routing path after facing an obstacle is independent of the calculated path before this obstacle. This obviates the need for using computationally costly dynamic programming algorithms to keep track of the subpath that provides optimal solution. The SneakySnake algorithm quickly and optimally solves the SNR problem and uses the found optimal path to decide whether performing sequence alignment is necessary. The key idea of Snake-on-Chip and Snake-on-GPU is to build specialized accelerators that judiciously leverage the parallelism-friendly architecture of modern FPGA (field-programmable gate array) and GPU (graphics processing unit) systems, respectively, to greatly speed up the SneakySnake algorithm.

# Results
Using real genomic data, we thoroughly evaluate the ability of our three pre-alignment filters to identify dissimilar genomic sequences and show that SneakySnake significantly improves the accuracy of pre-alignment filtering by up to four orders of magnitude compared to the state-of-the-art pre-alignment filters, Shouji, GateKeeper, and SHD. SneakySnake accelerates the state-of-the-art CPU-based sequence aligners, Edlib and Parasail, by up to 37.6× and 43.9×, respectively, without requiring hardware acceleration. The addition of Snake-on-Chip and Snake-on-GPU as a pre-alignment filter reduces the execution time of four state-of-the-art sequence aligners, designed for different computing platforms, by up to 689× (101× on average), without affecting their accuracy. This leads to the fastest and the most accurate pre-alignment filtering mechanism that we know of. Different from most existing works that aim to accelerate sequence alignment, our three pre-alignment filters do not sacrifice any of the aligner capabilities (i.e., scoring and backtracking), as they do not modify or replace the aligner. This provides an attractive way to reliably accelerate existing and future sequence alignment tools. 
